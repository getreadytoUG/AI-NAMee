import os
import json
import openai
from datasets import load_dataset

# openai.api_key = OPENAI_API_KEY

input_list=[
"아파트에서 층간소음으로 문제가 생겼을 때, 법적으로 어떻게 해결할 수 있나?",
"SNS에서 내 이미지를 무단으로 사용한 경우 법적으로 대응할 수 있나?",
"인터넷에서 허위 사실을 퍼뜨린 사람이 있으면 법적으로 어떻게 대응할 수 있나?",
"회사에서 정당한 이유 없이 승진을 누락했을 때, 법적으로 대응할 방법은?",
"인터넷에서 상품을 구매했는데 배송이 오지 않을 경우 법적으로 어떻게 할 수 있나?",
"주차장에서 차를 파손당했을 때 법적으로 보상을 받을 수 있나?",
"부당한 해고를 당했을 때, 법적으로 어떻게 대처할 수 있나?",
"근무 중 부상을 입었을 때 회사가 책임을 회피하려 하면 법적으로 대응할 수 있나?",
"은행에서 내 동의 없이 내 신용 정보를 조회했을 때 법적으로 문제가 되나?",
"전세 계약이 만료되었는데도 임차인이 퇴거하지 않을 경우 법적으로 어떻게 할 수 있나?",
"무단으로 내 음성 녹음을 한 사람이 있으면 법적으로 어떤 대응이 가능한가?",
"부동산 중개사가 매매 계약을 부실하게 처리했을 때, 법적으로 대응할 수 있나?",
"친구가 내 집을 무단으로 방문했을 때 법적 조치를 취할 수 있나?",
"상속 재산을 배분할 때 법적으로 반드시 따라야 할 기준은 무엇인가?",
"계약서에 명시되지 않은 추가 비용을 요구받을 때, 법적으로 대응할 수 있나?",
"학교 폭력을 당했을 때 법적으로 어떤 보호를 받을 수 있나?",
"온라인 게임에서 아이템을 사기 당했을 경우 법적으로 해결할 수 있나?",
"타인의 차량을 잠깐 빌렸는데 사고가 났을 때 법적 책임은 누구에게 있나?",
"회사에서 강제로 야근을 시킬 때 법적으로 거부할 수 있나?",
"친구에게 돈을 빌려줬을 때, 법적으로 이를 기록해 둘 방법은 무엇인가?",
"택배 기사가 내 물건을 분실했을 때 법적으로 보상을 요구할 수 있나?",
"타인의 명의를 도용해 온라인 계정을 만들었을 때 법적으로 어떤 처벌을 받을까?",
"사업장에서 발생한 화재로 내 물건이 파손되었을 때 법적으로 보상받을 수 있나?",
"집주인이 보증금을 반환하지 않을 때 법적으로 어떻게 대응할 수 있나?",
"식당에서 음식물로 인해 중독되었을 때 법적으로 배상을 요구할 수 있나?",
"이혼 시 자녀 양육권을 어떻게 법적으로 결정하나?",
"계약 기간이 끝나기 전에 회사를 그만두면 법적으로 어떤 문제가 생길 수 있나?",
"타인의 신용카드를 도용해서 온라인 구매를 했다면 법적으로 어떤 처벌을 받을까?",
"외국인이 한국에서 사업을 시작하려면 법적으로 어떤 절차를 밟아야 하나?",
"내가 계약한 업체가 일방적으로 계약을 파기하면 법적으로 어떻게 할 수 있나?",
"대중교통에서 성추행을 당했을 때 법적으로 어떻게 대응할 수 있나?",
"병원에서 잘못된 진단을 받았을 때 법적으로 보상을 받을 수 있나?",
"도로에서 교통법규를 위반한 차량을 목격했을 때 법적으로 신고할 수 있나?",
"공공장소에서 불법 촬영을 당했을 경우 법적으로 어떻게 대응할 수 있나?",
"타인의 물건을 파손했을 때 법적으로 어떤 배상을 해야 하나?",
"회사를 퇴사한 후에도 전 직장에서 내 개인정보를 사용할 경우 법적으로 문제 될 수 있나?",
"친구가 내 명의를 도용해 계약을 체결했다면 법적으로 어떻게 해결할 수 있나?",
"음식점에서 계산 착오로 추가 금액을 청구받았을 때 법적으로 대응할 수 있나?",
"학원에서 수업료 환불을 거부하면 법적으로 어떻게 할 수 있나?",
"공사 현장에서 발생한 소음 문제로 피해를 입었을 때 법적으로 보상을 받을 수 있나?",
"대리인을 통해 체결한 계약이 나에게 불리하게 작용할 때 법적으로 어떻게 할 수 있나?",
"회사에서 부당한 징계를 받았을 때 법적으로 어떻게 대응할 수 있나?",
"개인정보 유출로 인해 피해를 입었을 때 법적으로 보상을 받을 수 있나?",
"공공시설에서 다쳤을 경우 법적으로 어떤 보상을 받을 수 있나?",
"타인의 명예를 훼손하는 소문을 퍼뜨렸을 때 법적으로 어떤 처벌을 받을까?",
"보험금을 청구했는데 지급이 거부되었을 때 법적으로 어떻게 대응할 수 있나?",
"친구가 내 동의 없이 내 차를 운전하다 사고가 났을 때 법적 책임은 어떻게 되나?",
"상가 임대 계약 중 임대인이 무단으로 임대료를 인상하려 할 때 법적으로 막을 수 있나?",
"회사에서 부당하게 연차를 사용하지 못하게 할 때 법적으로 어떻게 대응할 수 있나?",
"내가 대출을 받아야 하는데 동의 없이 신용 조회가 이루어졌다면 법적으로 문제가 되나?",
"개인 파산을 신청하면 법적으로 어떤 절차를 거치나?",
"인터넷 게시판에서 익명으로 비방글을 작성하면 법적으로 문제가 되나?",
"택시 기사가 요금을 과다 청구했을 때 법적으로 대응할 수 있나?",
"부동산 계약서에 사소한 내용을 누락하면 법적 효력이 어떻게 되나?",
"해외에서 발생한 온라인 사기를 법적으로 신고할 수 있나?",
"공용 자전거를 무단으로 사용하면 법적으로 문제가 되나?",
"병원에서 의사가 잘못된 처방을 내렸을 때 법적으로 어떻게 대처할 수 있나?",
"내 집에 몰래카메라를 설치한 사람이 있다면 법적으로 어떻게 할 수 있나?",
"대출 이자를 부당하게 높게 책정한 경우 법적으로 어떻게 해결할 수 있나?",
"상속을 포기했는데도 빚을 갚으라는 요구를 받으면 법적으로 어떻게 대응할 수 있나?",
"법률 대리인이 계약을 맺었는데 문제가 생겼다면 법적 책임은 누구에게 있나?",
"동업자가 계약서 없이 사업에 참여하려 한다면 법적으로 어떻게 해야 하나?",
"차량 사고가 났는데 상대방이 보험 가입이 안 되어 있을 때 법적으로 어떻게 할 수 있나?",
"회사에서 부당한 업무를 강요할 때 법적으로 거부할 수 있나?",
"호텔에서 분실된 물건에 대해 법적으로 보상받을 수 있나?",
"무단으로 공공시설을 훼손했을 때 법적 처벌은 어떻게 되나?",
"타인이 내 이름으로 계약을 체결했을 때 법적으로 어떻게 대응할 수 있나?",
"부모님의 유산을 어떻게 법적으로 나눌 수 있나?",
"인터넷에서 주문한 상품이 불량품일 때 법적으로 환불을 요구할 수 있나?",
"회사에서 정당한 이유 없이 휴가를 거부할 때 법적으로 대응할 수 있나?",
"전자담배를 청소년에게 판매하면 법적으로 어떤 처벌을 받을까?",
"대리인 계약에서 발생한 손해는 법적으로 누구에게 책임이 있나?",
"무단으로 타인의 휴대전화를 사용한 경우 법적으로 어떤 처벌을 받을까?",
"타인의 영업 비밀을 유출했을 때 법적으로 어떤 처벌을 받나?",
"명예 훼손으로 고소당했을 때 법적으로 어떻게 대응할 수 있나?",
"유기 동물을 보호하는 법은 어떤 것들이 있나?",
"직장에서 차별을 당했을 때 법적으로 어떻게 대응할 수 있나?",
"타인의 글을 무단으로 복사해 블로그에 게재하면 법적으로 문제가 되나?",
"공무원이 아닌데도 공무원 신분을 사칭하면 법적으로 어떤 처벌을 받을까?",
"학교에서 부당하게 성적을 조작당했다면 법적으로 어떻게 대응할 수 있나?",
"자전거 도로에서 사고가 났을 때 법적 책임은 누구에게 있나?",
"회사에서 정당한 이유 없이 급여를 삭감할 때 법적으로 대응할 수 있나?",
"의료 사고로 인한 손해 배상을 법적으로 어떻게 요구할 수 있나?",
"부당하게 주택 임대차 계약이 해지되었을 때 법적으로 어떻게 해결할 수 있나?",
"상가에서 발생한 사고로 인해 손해를 입었을 때 법적으로 어떻게 대처할 수 있나?",
"사기 거래를 당했을 때 법적으로 어떻게 해결할 수 있나?",
"대리인이 아닌데도 대리 계약을 체결했을 경우 법적으로 문제가 생기나?",
"가족 간 금전 거래를 법적으로 기록해 둘 방법은 무엇인가?",
"퇴직금을 지급받지 못했을 때 법적으로 어떻게 요구할 수 있나?",
"전세 계약 종료 후에도 집주인이 보증금을 반환하지 않을 경우 법적으로 어떻게 대응할 수 있나?",
"온라인 강의에서 저작권이 침해되었을 경우 법적으로 어떻게 대응할 수 있나?",
"개인 간 차용증을 작성하지 않고 돈을 빌려줬을 때 법적으로 이를 증명할 수 있나?",
"내 동의 없이 개인정보가 수집되었을 때 법적으로 대응할 수 있나?",
"타인이 내 이름을 도용해 공공 서비스를 신청했다면 법적으로 어떻게 해결할 수 있나?",
"상사가 내 의사와 상관없이 업무를 강요할 때 법적으로 거부할 수 있나?",
"계약 종료 전에 회사가 계약을 파기하려 할 때 법적으로 어떻게 대응할 수 있나?",
"명예를 훼손당했을 때 법적으로 이를 증명하려면 어떤 자료가 필요하나?",
"개인 사업자가 세금 신고를 누락했을 때 법적으로 어떤 처벌을 받나?",
"주차장에서 타인이 내 차를 무단으로 사용했을 때 법적으로 대응할 수 있나?",
"해외 거주자가 한국에서 재산을 상속받을 때 법적으로 어떤 절차를 거쳐야 하나?"]

# file_path = r'C:\Users\eomjimin\Desktop\project\target_summary.json'
# with open(file_path, 'r', encoding='utf-8') as file:
#     raw_data = json.load(file)

# print(len(raw_data))

# for data in raw_data:
#     try:
#         eval(data['output'])    
#         print('eval!')
#     except:
#         print(data['output'])
try: 
    target_result = openai.chat.completions.create(
        model="gpt-4o-mini",
        messages=[
        {"role": "system", "content": "당신은 LLM 학습을 위한 LoRA 모델을 강화 및 학습시키기 위한 데이터셋 생성 작업을 수행하고 있습니다."},
        {"role": "user", "content": f"""안녕하세요. 데이터셋 생성 작업을 수행하고 있습니다. 다음 주어진 참고사항을 통해 input을 생성하고 그 질문에서 에서 년, 월, 일, 회의, 법률, 사람이름, 직책을 추출하여 answer를 딕셔너리 형태의 문자열로 생성한 뒤 예시를 참고하여 이를 딕셔너리 형태로 반환하세요.
            참고사항: input은 서로 달라야 하며 output에 있는 요소들은 포함될 수도, 되지 않을 수도 있습니다. 회의의 종류는 본회의, 국정감사, 소위원회, 예산결산특별위원회, 특별위원회 입니다. 이 외의 요소들은 국회 회의록에 있을법한 요소들로 자유롭게 지정하세요. 날짜는 1995년부터 2015년까지 입니다. 각 input은 회의록에서 궁금한 점을 검색하거나 특정 부분의 정리를 요청하는 형식입니다. 만들어야할 데이터셋은 총 100개 입니다. 입력은 총 100개의 문장으로 이루어진 list형태로 주어집니다. 이을 이용하여 다음과 같은 출력을 출력해주세요.
            예시입력:
            ["조국 장관이 본회의에서 후속 조치를 설명한 내용을 전부 요약해주세요.", "통신비밀보호법에 따르면 통신 기록을 보호받을 수 있어?"]
            예시출력:
            {{
                "input": "조국 장관이 본회의에서 후속 조치를 설명한 내용을 전부 요약해주세요.",
                "output": "{{'년': None, '월': None, '일': None, '회의': '본회의', '법률': None, '이름': '조국', '직책': '장관'}}"
            }}
            {{
                "input": "통신비밀보호법에 따르면 통신 기록을 보호받을 수 있어?",
                "output: "{{'년': None, '월': None, '일': None, '회의': None, '법률': "통신비밀보호법", '이름': "None", '직책': None}}"
            }}
           
            당신은 주어진 질문 외에 다른 문장은 응답하지 마세요. 당신의 응답을 바로 데이터셋으로 사용할 겁니다.
            input:
            {input_list}
            """},
        ],
        )
    target_summary = target_result.choices[0].message.content
    with open('target_summary.txt', 'a', encoding='utf-8') as f:
        f.write(target_summary)
    
except Exception as e:
    print(f"OpenAI API error: {e}")